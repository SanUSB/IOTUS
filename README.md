# IOTUS [![N|Solid](http://sanusb.blogspot.com.br/favicon.ico)](http://sanusb.org/iotus/sanusb.php)

This educational product IOTUS (IoT Update System) is a PaaS, that is, a platform as a service in which the user can create a profile and update scripts in C, Python or shell language on the Linux embedded system based on Raspberry Pi and also update the PIC family microcontroller hex firmware via RPI USB as illustrated in Figure 1. Thus, IOTUS consists of three main parts:
1. Linux Embedded System (ELS) based on Raspberry Pi.
2. Analog-digital converter embedded system (ADCES), which uses a SanUSB microcontroller, based on a free software and hardware tool with the PIC18Fxx5X family, including native USB interface;
3. WEB page for automatic update (upload) of scripts in real time.e the PIC family microcontroller hex firmware via RPI USB.

![](https://github.com/SanUSB/IOTUS/blob/main/Figures/UpdateIllust.png) 
Figure 1. Remote firmware and scripts update

Using the web page at http://sanusb.org/iotus/sanusb.php, illustrated in Figure 2, allows you to upload and update files in ELS with language extensions C (.c), Python (.py), Shell scripts (.sh) and in hexadecimal (.hex) in ADCES through the server. Due to network latency, the address of files to be uploaded to ELS and ADCES are variable and renamed with the user's profile along with the update version that starts with "0" and in each upload it is incremented. Considering the "ingenius" profile, if the first file is python, it will be automatically renamed to "ingenius0.py" and "ingenius1.py" will be the name of the script and, consequently, of the new URL address that will be used for download by ELS .

![](https://github.com/SanUSB/IOTUS/blob/main/Figures/UpdatePage.png) 
Figure 2. Proposed PaaS Profile and IOTUS Structure

IOTUS has been programmed to upload files to the server via the page http://sanusb.org/iot/sanusb.php, following these steps:
1. Insertion of the profile used by the student and and by ELS to download the file;
2. Look for the script in .c, .py, .sh or .hex to send for auto-update. Script examples can be downloaded from sanusb.org/iotus/examples.zip.
3. The 'Send' button performs the transfer of the file to the server which is later renamed and automatically transferred to the ELS.
IOTUS is programmed to work in a decentralized and distributed way, allowing multiple users and multiple simultaneous communications using the same cloud server. In the case of configuring or modifying IOTUS, basic knowledge about installing applications on the Linux operating system is required.
The PaaS profiles (PaaS A, B or N) illustrated in Figure 12 are free and automatically generated by the online server after registering the student profile, where it is possible to debug and/or test an IoT application. Thus, any user (A, B or N) can create and configure an IoT profile in the cloud in real time, as well as update firmware and script via the internet (Figure 3).

![](https://github.com/SanUSB/IOTUS/blob/main/Figures/UpdatePaaS.png) 
Figure 3. Proposed PaaS Profile and IOTUS Structure

O ADCES consiste na ferramenta de desenvolvimento livre que é composto de software e hardware livre da família PIC18Fxx5x com interface nativa USB. Esta ferramenta gratuita é eficiente no desenvolvimento de projetos porque não há necessidade de remover o microcontrolador para a atualização de firmware, diferente de outros sistemas de desenvolvimento que usam normalmente um hardware de gravação específico e trabalham via cabo. Além disso, a ferramenta SanUSB é multiplataforma, ou seja, pode ser utilizada em Windows®, Mac OSX e Linux, além de ser plug and play, ou seja, é automaticamente reconhecida pelos sistemas operacionais sem a necessidade de instalar qualquer driver.
Assim, esta ferramenta permite que a compilação, gravação e emulação de um programa possa ser feita de forma rápida e eficiente a partir da conexão do microcontrolador em um sistema computacional via USB, que nesta aplicação é um RPi.
O sistema computacional RPi pode ser implementado diretamente em projetos de eletrônica, principalmente devido aos seus pinos de entrada/saída (I/O) de uso geral (GPIO) com suporte para sensores digitais, atuadores e protocolos I²C e SPI para executar comunicações com periféricos. A variedade de comunicação permite que o RPi se comunique com um número maior de periféricos e o uso da biblioteca de acesso aos pinos Wiring Pi  escrita em C, facilita a programação e configuração dos pinos GPIO através de um utilitário de linha de comando "gpio". Existem duas formas de comunicação entre ADCES e RPi neste projeto: comunicação serial e interface USB. Para executar a comunicação serial entre um microcontrolador PIC e os pinos RPi do ELS, ground (GND), GPIO 14 (TX) e GPIO 15 (RX) são usados. Nesse projeto proposto, o sistema computacional utilizado para gravar o microcontrolador PIC (ADCES) é o RPi (ELS), cujos pinos de conexão para comunicação USB e serial são mostrados na Figura 4.

![](https://github.com/SanUSB/IOTUS/blob/main/Figures/UpdatePIC.png) 
Figure 4. Serial connection between ADCES (SanUSB board) (a) and RPi (b)

