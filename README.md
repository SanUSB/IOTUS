# IOTUS [![N|Solid](http://sanusb.blogspot.com.br/favicon.ico)](http://sanusb.org/iotus/sanusb.php)


This educational product IOTUS (IoT Update System) is a PaaS, that is, a platform as a service in which the user can create a profile and update scripts in C, Python or shell language on the Linux embedded system based on Raspberry Pi and also update the PIC family microcontroller hex firmware via RPI USB as illustrated in Figure 1. Thus, IOTUS consists of three main parts:
1. Linux Embedded System (ELS) based on Raspberry Pi.
2. Analog-digital converter embedded system (ADCES), which uses a SanUSB microcontroller, based on a free software and hardware tool with the PIC18Fxx5X family, including native USB interface;
3. WEB page http://sanusb.org/iot/sanusb.php for automatic update (upload) of scripts in real time.e the PIC family microcontroller hex firmware via RPI USB.

![](https://github.com/SanUSB/IOTUS/blob/main/Figures/UpdateIllust.png) 

Figure 1. Remote firmware and scripts update


Using the web page at http://sanusb.org/iotus/sanusb.php, illustrated in Figure 2, allows you to upload and update files in ELS with language extensions C (.c), Python (.py), Shell scripts (.sh) and in hexadecimal (.hex) in ADCES through the server. Due to network latency, the address of files to be uploaded to ELS and ADCES are variable and renamed with the user's profile along with the update version that starts with "0" and in each upload it is incremented. Considering the "ingenius" profile, if the first file is python, it will be automatically renamed to "ingenius0.py" and "ingenius1.py" will be the name of the new script and, consequently, of the new URL address that will be used for download by ELS .

![](https://github.com/SanUSB/IOTUS/blob/main/Figures/UpdatePage.png) 

Figure 2. Proposed PaaS Profile and IOTUS Structure


IOTUS has been programmed to upload files to the server via the page http://sanusb.org/iot/sanusb.php, following these steps:
1. Insertion of the profile used by the student and and by ELS to download the file;
2. Look for the script in .c, .py, .sh or .hex to send for auto-update. Script examples can be downloaded from sanusb.org/iotus/examples.zip.
3. The 'Send' button performs the transfer of the file to the server which is later renamed and automatically transferred to the ELS.
IOTUS is programmed to work in a decentralized and distributed way, allowing multiple users and multiple simultaneous communications using the same cloud server. In the case of configuring or modifying IOTUS, basic knowledge about installing applications on the Linux operating system is required.
The PaaS profiles (PaaS A, B or N) illustrated in Figure 12 are free and automatically generated by the online server after registering the student profile, where it is possible to debug and/or test an IoT application. Thus, any user (A, B or N) can create and configure an IoT profile in the cloud in real time, as well as update firmware and script via the internet (Figure 3).

![](https://github.com/SanUSB/IOTUS/blob/main/Figures/UpdatePaaS.png) 

Figure 3. Proposed PaaS Profile and IOTUS Structure


ADCES is a free development tool that is composed of free software and hardware from the PIC18Fxx5x family with native USB interface. This free tool is efficient in project development because there is no need to remove the microcontroller to update the firmware, unlike other development systems that normally use specific recording hardware and work via cable. In addition, the SanUSB tool is cross-platform, that is, it can be used on Windows®, Mac OSX and Linux, in addition to being plug and play, that is, it is automatically recognized by operating systems without the need to install any driver.
Thus, this tool allows the compilation, recording and emulation of a program to be done quickly and efficiently by connecting the microcontroller to a computer system via USB, which in this application is an RPi.
The RPi computing system can be directly implemented in electronics projects, mainly due to its general purpose input/output (I/O) pins (GPIO) with support for digital sensors, actuators and I²C and SPI protocols to perform communications with peripherals. The communication variety allows the RPi to communicate with a greater number of peripherals and the use of the Wiring Pi pin access library written in C, makes it easy to program and configure the GPIO pins through a "gpio" command line utility . There are two ways of communication between ADCES and RPi in this project: serial communication and USB interface. To perform serial communication between a PIC microcontroller and the RPi pins of the ELS, ground (GND), GPIO 14 (TX) and GPIO 15 (RX) are used. In this proposed project, the computational system used to programm the PIC microcontroller (ADCES) via USB is the RPi (ELS), whose connection pins for USB and serial communication are shown in Figure 4.

![](https://github.com/SanUSB/IOTUS/blob/main/Figures/UpdatePIC.png) 

Figure 4. Serial connection between ADCES (SanUSB board) (a) and RPi (b)

Operation details in the video at https://youtu.be/CsTcVQtUxeQ.

